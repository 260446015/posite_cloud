<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title class="title" data-href="index">报告管理</title>
    <meta name="renderer" content="webkit"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=0, maximum-scale=0, user-scalable=no">
    <meta name="Author" Content="jianghaifei"/>
    <meta http-equiv="cache-control" content="no-cache">
    <link rel="shortcut icon" href="../img/logozkjl2.png">

    <!--不缓存-->
    <META HTTP-EQUIV="pragma" CONTENT="no-cache">
    <META HTTP-EQUIV="Cache-Control" CONTENT="no-cache, must-revalidate">
    <META HTTP-EQUIV="expires" CONTENT="0">

    <script src="../js/common/jquery-3.3.1.min.js"></script>
    <!--animate-->
    <link rel="stylesheet" href="../css/common/animate.css">
    <!--layui-->
    <link rel="stylesheet" href="../res/layui/css/layui.css">

    <!--自定义-->
    <link rel="stylesheet" href="../css/common/common.css?version=0">
    <link rel="stylesheet" href="../css/common/layout.css?version=0">
    <link rel="stylesheet" href="../css/inportant.css?version=0">
    <style>
        body{
            background: #edeef2;
        }
        .section{
            background: #fff;
        }
        .zd_box div span {
            width: 25%;
        }
        .zd_box p {
            min-height: 0;
        }
        .icon-zhankaigengduo{
            width: 30px;
            height: 30px;
            display: inline-block;
        }
        .zd_box div {
            height: auto;
            line-height: 30px;
            overflow: hidden;
            margin-top: -1px;
        }
        .renwulis{
            border-top: 1px solid #eee;
            border-bottom: 1px solid #eee;
            overflow: hidden;
            display: block;
            clear: both;
            padding: 10px;
            background: #fff;
            display: none;
        }
        .renwulis i{
            float: left;
            width: 25%;
            overflow: hidden;
        }
        .renwulis a{
            float: left;
            width: 80%;
            margin-left: 1%;
            text-overflow: ellipsis;
            white-space: nowrap;
            overflow: hidden;
        }
        .renwulis .layui-form-checkbox{
            float: left;
            margin: 5px 0 0 10px;
            width: 100%;
        }
        .layui-form-checkbox[lay-skin=primary] i {
            float: left;
        }
        .layui-form-checkbox[lay-skin=primary] span {
            width: 89%;
            text-align: left;
            padding-left: 1%;
        }
        .layui-form-checkbox span {
           padding: 0;
        }
        .shoucang{
            cursor: pointer;
        }
        .iconfont{
            color: #999;
        }
    </style>
</head>
<body>
<header>
    <img class="logobox" src="../img/logozkjl1.png" alt="">
    <div class="title">
        <p>联知重点人筛查系统</p>
        <p>Key    person    screening</p>
    </div>
    <div class="hd_nav">
        <a href="../index.html">首页</a>
        <a href="importan.html">重点人员</a><a href="reportindex.html">报告管理</a>
        <a class="com_jifen" href="jifenyj.html">积分预警</a>
        <!--<a href="report.html">生成报告</a>-->
        <a href="caijishezhi.html">采集设置</a>
        <!--<a>追踪人员</a>-->
        <a class="com_gunli" href="houtai_user.html">后台管理</a>
    </div>
    <dl class="hd_dl">
        <dd><span class="usernamecon"></span><span class="headerimg"><img src="../img/defaultimg.png" alt=""></span></dd>
        <dt class="hd_dt layui-anim layui-anim-upbit">
            <p class="logout">退出登录</p>
            <p class="go_person">个人中心</p>
        </dt>
    </dl>
</header>
<section>
    <div class="se_title">
        <p><a href="../index.html">HOME</a>   /   报告管理</p>
    </div>
    <div class="section">
        <div class="htbtnbox">
            <a href="reportindex.html" class="ht_btn">个人报告</a>
            <a href="re_renwu.html" class="ht_btn">任务报告</a>
            <a style="border-right: 1px solid #ccc;" href="re_pingtai.html" class="ht_btn ht_active">平台报告</a>
        </div>

        <div class="messhuo">您可以根据需要，选择标记要导出报告的电话号码，生成批量号码报告。<span class="layui-btn layui-btn-normal baocunbtn baocunbtn2" style="float: none;">生成批量个人报告</span></div>
        <div class="zd_box layui-form" style="overflow: hidden;">
            <div class="sc_zdgray">
                <span>序号</span>
                <span>平台类别</span>
                <span>报告</span>
                <span>操作</span>
            </div>
            <p class="zd_boxlist">
                <div>
                    <span>1</span>
                    <span>网络赌博</span>
                    <span class="cha_report" data-href="赌博"><span class="layui-btn layui-btn-normal baocunbtn baocunbtn2" style="float: none;">查看报告</span></span>
                    <span class="shoucang" data-href="true"><i class="iconfont icon-zhankaigengduo"></i></span>
                    <h3 class="renwulis"></h3>
                </div>
                <div class="sc_zdgray">
                    <span>2</span>
                    <span>网络贷款</span>
                    <span class="cha_report" data-href="贷款"><span class="layui-btn layui-btn-normal baocunbtn baocunbtn2" style="float: none;">查看报告</span></span>
                    <span class="shoucang" data-href="true"><i class="iconfont icon-zhankaigengduo"></i></span>
                    <h3 class="renwulis"></h3>
                </div>
                <div>
                    <span>3</span>
                    <span>涉黄平台</span>
                    <span class="cha_report" data-href="涉黄"><span class="layui-btn layui-btn-normal baocunbtn baocunbtn2" style="float: none;">查看报告</span></span>
                    <span class="shoucang" data-href="true"><i class="iconfont icon-zhankaigengduo"></i></span>
                    <h3 class="renwulis"></h3>
                </div>
                <div class="sc_zdgray">
                    <span>4</span>
                    <span>网络直播</span>
                    <span class="cha_report" data-href="直播"><span class="layui-btn layui-btn-normal baocunbtn baocunbtn2" style="float: none;">查看报告</span></span>
                    <span class="shoucang" data-href="true"><i class="iconfont icon-zhankaigengduo"></i></span>
                    <h3 class="renwulis"></h3>
                </div>
                <div>
                    <span>5</span>
                    <span>网络游戏</span>
                    <span class="cha_report" data-href="游戏"><span class="layui-btn layui-btn-normal baocunbtn baocunbtn2" style="float: none;">查看报告</span></span>
                    <span class="shoucang" data-href="true"><i class="iconfont icon-zhankaigengduo"></i></span>
                    <h3 class="renwulis"></h3>
                </div>
            </p>
        </div>
    </div>
</section>
</body>
<script src="../res/layui/layui.all.js"></script>
<script src="../js/common/common.js?versin=0"></script>
<script>
    //分页设置
    layui.use(['laypage','layer','element','form']);
    var laypage = layui.laypage;
    var element = layui.element;
    var form = layui.form;
    //任务列表
    getrenwu();
    function getrenwu() {
        $(".sc_renwu").empty();
        $.ajax({
            url: "/api/listJob",
            type: "get",
            xhrFields: {
                withCredentials: true
            },
            data:{},
            success: function (res) {
                console.log(res)
                if (res.code != 0) {
                    //return layer.msg(res.message, {anim: 6});
                }
                if(res.data.job.length==0){
                    $(".sc_renwu,.im_contenlist").append('<h3 class="kongbai"><img src="../img/zanwushuju.png" alt=""></h3>');
                }
                $.each(res.data.job,function (i,item) {
                    var list;
                    var otext = "";
                    var key = "否";
                    var ospan = "";
                    if(item.taskname){
                        otext = item.taskname;
                    }else{
                        otext = zdrysc.timechange(item.creationTime);
                    }
                    if(item.ifFinish){
                        list = '<i><input type="checkbox" class="quanxuna" name="like1[read]" lay-skin="primary"  lay-filter="quanxuan" title="'+otext+'" value="'+item.taskId+'"></i>'
                    }else{
                        list = '<i><input type="checkbox" class="quanxuna" name="like1[read]" lay-skin="primary"  lay-filter="quanxuan" title="'+otext+'" value="'+item.taskId+'" disabled></i>'
                    }
                    $(".renwulis").append(list);
                });
                form.render();
            }
        });
    }

    $(".shoucang").click(function () {
        if($(this).attr("data-href")=="true"){
            $(this).html('<i class="iconfont icon-shouqi"></i>');
            $(this).parent("div").find(".renwulis").slideDown();
            $(this).attr("data-href",false);
        }else{
            $(this).html('<i class="iconfont icon-zhankaigengduo"></i>');
            $(this).parent("div").find(".renwulis").slideUp();
            $(this).attr("data-href",true);
        }
    });

    $(".cha_report").click(function () {
        var _this = $(this).parent("div").find(".renwulis");
        var _othis = $(this).parent("div").find(".shoucang");
        var olist = [];
        _this.find(".layui-form-checkbox").each(function (i,item) {
            var oid = $(this).siblings("input").attr("value");
            if(item.getAttribute("class")=="layui-unselect layui-form-checkbox layui-form-checked"){
                olist.push(oid)
            }
        });
        if(olist.length==0){
            _othis.attr("data-href",false);
            _this.slideDown();
            _othis.html('<i class="iconfont icon-shouqi"></i>');
            return layer.msg("请选择需要生成报告的任务");
        }
        console.log(olist)
        sessionStorage.setItem("zdrsc_data",JSON.stringify(olist));
        sessionStorage.setItem("zdrsc_name",$(this).attr("data-href"));
        window.location = "repotr_renwuallpingtai.html"
    });
</script>
</html>